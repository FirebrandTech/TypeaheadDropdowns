var TypeaheadDropdowns=function(){this._initialized=!1;this.namingPrefix="fbt-dd-";this.classNames={highlight:namingPrefix+"highlight",hidden:namingPrefix+"hidden",input:namingPrefix+"autocomplete",dropdown:namingPrefix+"autocomplete-dropdown",matchingText:namingPrefix+"dropdown-match"};var x=function(b,a){this.data=b;this.index=a;this.next=this.previous=null},r=function(){this.length=0;this.tail=this.head=null};r.prototype.add=function(b,a){var c=new x(b,a);0<this.length?(this.tail.next=c,c.previous=
this.tail):this.head=c;this.tail=c;this.length++;return c};r.prototype.getNodeAtPosition=function(b){var a=this.head,c=0;for((0===this.length||0>b||b>=this.length)&&console.warn("Error: No node exists at position "+b);c<b;)a=a.next,c++;return a};var p=function(b){var a=this,c=b.id||"select-"+namingPrefix+"-"+y(8),f="input-"+namingPrefix+c,g="ul-"+namingPrefix+c,e=document.getElementById(f)||document.createElement("input"),l=document.getElementById(g)||document.createElement("ul");b.id=c;e.id=f;l.id=
g;l.innerHTML="";a.select=b;a.ul=l;a.input=e;a.selectedItem=void 0;a.selectedItemIndex=void 0;a.visibleItems=void 0;a.visibleItemPositions=[];a.selectedItemValue=a.input.value;e.className=classNames.input;e.autocomplete="off";z(b,e,"font");b.parentNode.insertBefore(e,b);l.className=classNames.dropdown;for(var n=0;n<b.options.length;n++)c=b.options[n],f=document.createElement("li"),A(f,c.text),c.selected&&(a.selectedItem=f,a.selectedItemIndex=n),f.onmousedown=function(b){a.input.value=k(b.target);
a.selectedItem=b.target;a.selectedItemIndex=n;a.hide()},f.onmouseenter=function(a){t(a.target,classNames.highlight)},l.appendChild(f);document.body.appendChild(l);a.select.title=k(a.selectedItem);a.hide();a.ul.onmouseover=function(a){a=l.querySelector("li."+classNames.highlight);q(a,classNames.highlight)};a.select.onmousedown=function(b){b.preventDefault();a.select.focus()};a.select.onfocus=function(d){if(-1===b.selectedIndex)return!0;d=d.target.getBoundingClientRect();v(e,d.top,d.left,d.width);a.show();
d=e.getBoundingClientRect();v(l,d.bottom,d.left,d.width-e.clientLeft,!0);e.value=b[b.selectedIndex].text;a.update(!0);e.select();return!1};var m=function(){var a=document.createEvent("UIEvent");a.initEvent("blur",!0,!0);e.dispatchEvent(a)};document.addEventListener("scroll",function(b){a.visible&&m()});a.input.onblur=function(d){selectedText=e.value;for(d=0;d<b.options.length;d++)if(k(b.options[d]).trim()===selectedText){if(b.selectedIndex==d)break;b.selectedIndex=d;a.selectedItem=a.ul.getElementsByTagName("li")[d];
a.selectedItemIndex=d;a.selectedItemValue=selectedText;a.select.title=k(a.selectedItem);d=document.createEvent("UIEvent");d.initEvent("change",!0,!0);b.dispatchEvent(d);break}a.hide();return!1};a.input.onkeydown=function(b){if(38===b.keyCode)b=a.visibleItems.getNodeAtPosition(a.visibleItemPositions[a.selectedItemIndex]),null!==b.previous&&(a.selectedItem=b.previous.data,a.selectedItemIndex=b.previous.index,a.highlightSelected(),a.input.value=k(a.selectedItem),a.input.focus()),u(a.selectedItem,a.ul)||
(a.ul.scrollTop=a.selectedItem.offsetTop),window.setTimeout(function(){a.input.setSelectionRange(a.input.value.length,a.input.value.length)},0);else if(40===b.keyCode){b=a.visibleItemPositions[a.selectedItemIndex];var c;if("undefined"===typeof a.selectedItem||"undefined"===typeof b){a.selectedItemIndex=a.getFirstVisibleItemIndex();b=a.visibleItemPositions[a.selectedItemIndex];if("undefined"===typeof a.selectedItemIndex||"undefined"===typeof b)return;c=a.visibleItems.getNodeAtPosition(a.visibleItemPositions[a.selectedItemIndex])}else b=
a.visibleItemPositions[a.selectedItemIndex],b=a.visibleItems.getNodeAtPosition(a.visibleItemPositions[a.selectedItemIndex]),null!==b.next&&(c=b.next);"undefined"!==typeof c&&(a.selectedItem=c.data,a.selectedItemIndex=c.index,a.highlightSelected(),a.input.value=k(a.selectedItem),u(a.selectedItem,a.ul)||(a.ul.scrollTop=a.selectedItem.offsetTop-(a.ul.clientHeight-a.selectedItem.offsetHeight)))}else if(10===b.keyCode||13===b.keyCode||27===b.keyCode)return m(),!1};a.input.onkeyup=function(b){if(b.target.value!==
a.selectedItemValue){if(w([37,38,39,40,9,16,17,18,19,20,35,36,45,91,92,112,113,114,115,116,117,118,119,120,121,122,123],b.keyCode))return!0;a.selectedItemValue=b.target.value;a.selectedItemIndex=void 0;a.selectedItem=void 0;highlightedItem=a.ul.querySelector("li."+classNames.highlight);null!==highlightedItem&&q(highlightedItem,classNames.highlight);window.setTimeout(function(){a.update(!1)},0)}}};p.prototype.getFirstVisibleItemIndex=function(){for(var b=0;b<this.visibleItemPositions.length;b++)if("undefined"!==
typeof this.visibleItemPositions[b])return b;return 0};p.prototype.highlightSelected=function(){var b=this.ul.querySelector("li."+classNames.highlight);q(b,classNames.highlight);t(this.selectedItem,classNames.highlight)};p.prototype.show=function(){this.visible=!0;this.input.hidden=!1;this.ul.hidden=!1;this.select.hidden=!0};p.prototype.hide=function(){this.visible=!1;this.input.hidden=!0;this.ul.hidden=!0;this.select.hidden=!1;this.select.blur()};p.prototype.update=function(b){for(var a=this.input.value.toLowerCase().replace(/[-[\]{}()*+?.,\\^$|#\s]/g,
"\\$&"),c=this.ul.getElementsByTagName("li"),f=[],g=[],e=new r,l=[],n=0,m=0;m<c.length;m++){var d=c[m];b||null!==k(d).toLowerCase().match(a)?(g.push(d),e.add(d,m),l[m]=n++):f.push(d)}f.map(function(a){t(a,classNames.hidden)});g.map(function(a){q(a,classNames.hidden)});"undefined"!==typeof this.selectedItem&&this.highlightSelected();this.visibleItems=e;this.visibleItemPositions=l;u(this.selectedItem,this.ul)||(this.ul.scrollTop=this.selectedItem.offsetTop)};var B=function(b){var a=document.head||document.getElementsByTagName("head")[0],
c=document.createElement("style");b=".{{classNames.hidden}} { \r\n      display: none; \r\n} \r\ninput.{{classNames.input}} { \r\n      padding-left: 7px; \r\n} \r\nul.{{classNames.dropdown}} { \r\n      position: absolute; \r\n      background: white; \r\n      padding-left: 0px; \r\n      margin: 0px; \r\n      max-height: 200px; \r\n      overflow-y: auto; \r\n      border: solid rgb(121, 155, 210) 1px; \r\n      text-align: left; \r\n      z-index: 999999; \r\n} \r\nul.{{classNames.dropdown}} li { \r\n      list-style-type: none; \r\n      cursor: default; \r\n      padding-left: 7px; \r\n} \r\nul.{{classNames.dropdown}} li.{{classNames.highlight}} { \r\n      background: rgb(30, 144, 255); \r\n      color: white; \r\n} \r\nul.{{classNames.dropdown}} li span.{{classNames.matchingText}} { \r\n      font-weight: bold; \r\n      color: purple; \r\n    } \r\n".replace(/{{(.*?)}}/g,
function(a){return eval(a)});c.type="text/css";c.styleSheet?style.styleSheet.cssText=b:c.appendChild(document.createTextNode(b));a.appendChild(c)},u=function(b,a){if("undefined"===typeof b||"undefined"===typeof a)return!0;var c=a.scrollTop,f=c+a.clientHeight,g=b.offsetTop,e=g+b.offsetHeight;return g>=c&&e<=f},w=function(b,a){return 0===b.length?!1:b.map(function(b){return b===a}).reduce(function(a,b){return a||b})},v=function(b,a,c,f,g){var e=window.pageXOffset||document.documentElement.scrollLeft||
document.body.scrollLeft||0;b.style.top=a+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0)+"px";b.style.left=c+e+"px";g?b.style.minWidth=f+"px":b.style.width=f+"px"},z=function(b,a,c){a.style[c]=window.getComputedStyle(b)[c]},q=function(b,a){""!==a&&"undefined"!==typeof b&&null!==b&&(b.className=b.className.replace(new RegExp("(?:^|\\s)"+a+"(?!\\S)","gi"),""))},t=function(b,a){""===b.className?b.className=a:-1===b.className.toLowerCase().indexOf(a.toLowerCase())&&
(b.className+=" "+a)},A=function(b,a){b.hasOwnProperty("innerText")?b.innerText=a:b.textContent=a},k=function(b,a){if("undefined"!==typeof b)return b.hasOwnProperty("innerText")?b.innerText:b.textContent},y=function(b){for(var a="",c=0;c<b;c++)a+="abcdefghijklmnopqrstuvwxyz".charAt(Math.floor(26*Math.random()));return a},C=function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||
Element.prototype.webkitMatchesSelector||function(b){b=(this.document||this.ownerDocument).querySelectorAll(b);for(var a=b.length;0<=--a&&b.item(a)!==this;);return-1<a})},D=function(b){var a={attributes:!1,childList:!0,characterData:!1,subtree:!0},c=new MutationObserver(function(e){var f=[],g=[],m=[];e.forEach(function(d){for(var e=0;e<d.addedNodes.length;e++){var h=d.addedNodes[e];if(1==h.nodeType){var k=h.querySelectorAll(b);if(h.matches(b))f.push(h),c.observe(h,a);else if(0<k.length)for(h=0;h<
k.length;h++)f.push(k[h]),c.observe(k[h],a);else"option"===h.tagName.toLowerCase()&&(w(g,h.parentNode)||g.push(h.parentNode))}}for(e=0;e<d.removedNodes.length;e++)h=d.removedNodes[e],"undefined"!==typeof h.tagName&&h.matches(b)&&m.push(h)});f.forEach(function(a){TypeaheadDropdowns.initFromNode(a)});g.forEach(function(a){TypeaheadDropdowns.initFromNode(a)});m.forEach(function(a){var b=a.id;"undefined"!==typeof b&&(a="input-"+namingPrefix+b,b="ul-"+namingPrefix+b,input=document.getElementById(a),ul=
document.getElementById(b),input&&input.parentElement.removeChild(input),ul&&ul.parentElement.removeChild(ul))})});c.observe(document.body,a);for(var f=document.querySelectorAll(b),g=0;g<f.length;g++)c.observe(f[g],a)};return{init:function(b){if(!this._initialized){if(MutationObserver){b=b||"select";D(b);B();C();b=document.querySelectorAll(b);for(var a=0;a<b.length;a++)"select"!==b[a].tagName.toLowerCase()?console.log("The selector passed to TypeaheadDropdowns.init() should only include <select> elements.  Skipping: "+
b[a].tagName):new p(b[a])}else console.log("TypeaheadDropdowns cannot be initialized, because this browser does not support the MutationObserver API.");this._initialized=!0}},initFromNode:function(b){"select"===b.tagName.toLowerCase()&&new p(b)}}}();
